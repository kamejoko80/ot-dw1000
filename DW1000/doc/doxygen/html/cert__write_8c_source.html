<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>third_party/mbedtls/repo/programs/x509/cert_write.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Open-Thread-Logo-200x42.png"/></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">CLI and NCP Application</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_44f42edf5dd23d4deca0321224e9ce90.html">third_party</a></li><li class="navelem"><a class="el" href="dir_2c3d6607fdac3e9186e98b5e2f588509.html">mbedtls</a></li><li class="navelem"><a class="el" href="dir_2dc104378b4059f668847b2a8b47063b.html">repo</a></li><li class="navelem"><a class="el" href="dir_56672f937ec54928cff4eb4c52e260b9.html">programs</a></li><li class="navelem"><a class="el" href="dir_3763c1db7b13e09bfd4174f9d8d48155.html">x509</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">cert_write.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="cert__write_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *  Certificate generation and signing</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *  SPDX-License-Identifier: Apache-2.0</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *  not use this file except in compliance with the License.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *  You may obtain a copy of the License at</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *  http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *  Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *  distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *  See the License for the specific language governing permissions and</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *  limitations under the License.</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *  This file is part of mbed TLS (https://tls.mbed.org)</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#if !defined(MBEDTLS_CONFIG_FILE)</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="config_8h.html">mbedtls/config.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include MBEDTLS_CONFIG_FILE</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_PLATFORM_C)</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="third__party_2mbedtls_2repo_2include_2mbedtls_2platform_8h.html">mbedtls/platform.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">   32</a></span>&#160;<span class="preprocessor">#define mbedtls_printf     printf</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#if !defined(MBEDTLS_X509_CRT_WRITE_C) || \</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">    !defined(MBEDTLS_X509_CRT_PARSE_C) || !defined(MBEDTLS_FS_IO) || \</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">    !defined(MBEDTLS_ENTROPY_C) || !defined(MBEDTLS_CTR_DRBG_C) || \</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">    !defined(MBEDTLS_ERROR_C) || !defined(MBEDTLS_SHA256_C) || \</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">    !defined(MBEDTLS_PEM_WRITE_C)</span></div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="cert__write_8c.html#a840291bc02cba5474a4cb46a9b9566fe">   40</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="cert__write_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a>( <span class="keywordtype">void</span> )</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;MBEDTLS_X509_CRT_WRITE_C and/or MBEDTLS_X509_CRT_PARSE_C and/or &quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            <span class="stringliteral">&quot;MBEDTLS_FS_IO and/or MBEDTLS_SHA256_C and/or &quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;            <span class="stringliteral">&quot;MBEDTLS_ENTROPY_C and/or MBEDTLS_CTR_DRBG_C and/or &quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <span class="stringliteral">&quot;MBEDTLS_ERROR_C not defined.\n&quot;</span>);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="x509__crt_8h.html">mbedtls/x509_crt.h</a>&quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="x509__csr_8h.html">mbedtls/x509_csr.h</a>&quot;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="entropy_8h.html">mbedtls/entropy.h</a>&quot;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ctr__drbg_8h.html">mbedtls/ctr_drbg.h</a>&quot;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="error_8h.html">mbedtls/error.h</a>&quot;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_X509_CSR_PARSE_C)</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#define USAGE_CSR                                                           \</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">    &quot;    request_file=%%s     default: (empty)\n&quot;                           \</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">    &quot;                        If request_file is specified, subject_key,\n&quot;  \</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">    &quot;                        subject_pwd and subject_name are ignored!\n&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#define USAGE_CSR &quot;&quot;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_X509_CSR_PARSE_C */</span><span class="preprocessor"></span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#define DFL_ISSUER_CRT          &quot;&quot;</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#define DFL_REQUEST_FILE        &quot;&quot;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#define DFL_SUBJECT_KEY         &quot;subject.key&quot;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#define DFL_ISSUER_KEY          &quot;ca.key&quot;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#define DFL_SUBJECT_PWD         &quot;&quot;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#define DFL_ISSUER_PWD          &quot;&quot;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#define DFL_OUTPUT_FILENAME     &quot;cert.crt&quot;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#define DFL_SUBJECT_NAME        &quot;CN=Cert,O=mbed TLS,C=UK&quot;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#define DFL_ISSUER_NAME         &quot;CN=CA,O=mbed TLS,C=UK&quot;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#define DFL_NOT_BEFORE          &quot;20010101000000&quot;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#define DFL_NOT_AFTER           &quot;20301231235959&quot;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#define DFL_SERIAL              &quot;1&quot;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#define DFL_SELFSIGN            0</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#define DFL_IS_CA               0</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#define DFL_MAX_PATHLEN         -1</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#define DFL_KEY_USAGE           0</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#define DFL_NS_CERT_TYPE        0</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#define USAGE \</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">    &quot;\n usage: cert_write param=&lt;&gt;...\n&quot;                \</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">    &quot;\n acceptable parameters:\n&quot;                       \</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">    USAGE_CSR                                           \</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">    &quot;    subject_key=%%s      default: subject.key\n&quot;   \</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">    &quot;    subject_pwd=%%s      default: (empty)\n&quot;       \</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">    &quot;    subject_name=%%s     default: CN=Cert,O=mbed TLS,C=UK\n&quot;   \</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">    &quot;\n&quot;                                                \</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">    &quot;    issuer_crt=%%s       default: (empty)\n&quot;       \</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">    &quot;                        If issuer_crt is specified, issuer_name is\n&quot;  \</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">    &quot;                        ignored!\n&quot;                \</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">    &quot;    issuer_name=%%s      default: CN=CA,O=mbed TLS,C=UK\n&quot;     \</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">    &quot;\n&quot;                                                \</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">    &quot;    selfsign=%%d         default: 0 (false)\n&quot;     \</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">    &quot;                        If selfsign is enabled, issuer_name and\n&quot; \</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">    &quot;                        issuer_key are required (issuer_crt and\n&quot; \</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">    &quot;                        subject_* are ignored\n&quot;   \</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">    &quot;    issuer_key=%%s       default: ca.key\n&quot;        \</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">    &quot;    issuer_pwd=%%s       default: (empty)\n&quot;       \</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">    &quot;    output_file=%%s      default: cert.crt\n&quot;      \</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">    &quot;    serial=%%s           default: 1\n&quot;             \</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">    &quot;    not_before=%%s       default: 20010101000000\n&quot;\</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">    &quot;    not_after=%%s        default: 20301231235959\n&quot;\</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">    &quot;    is_ca=%%d            default: 0 (disabled)\n&quot;  \</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">    &quot;    max_pathlen=%%d      default: -1 (none)\n&quot;     \</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">    &quot;    key_usage=%%s        default: (empty)\n&quot;       \</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">    &quot;                        Comma-separated-list of values:\n&quot;     \</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">    &quot;                          digital_signature\n&quot;     \</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">    &quot;                          non_repudiation\n&quot;       \</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">    &quot;                          key_encipherment\n&quot;      \</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">    &quot;                          data_encipherment\n&quot;     \</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">    &quot;                          key_agreement\n&quot;         \</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">    &quot;                          key_cert_sign\n&quot;  \</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">    &quot;                          crl_sign\n&quot;              \</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">    &quot;    ns_cert_type=%%s     default: (empty)\n&quot;       \</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">    &quot;                        Comma-separated-list of values:\n&quot;     \</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor">    &quot;                          ssl_client\n&quot;            \</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">    &quot;                          ssl_server\n&quot;            \</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">    &quot;                          email\n&quot;                 \</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">    &quot;                          object_signing\n&quot;        \</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">    &quot;                          ssl_ca\n&quot;                \</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">    &quot;                          email_ca\n&quot;              \</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor">    &quot;                          object_signing_ca\n&quot;     \</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">    &quot;\n&quot;</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"> * global options</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keyword">struct </span>options</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *issuer_crt;     <span class="comment">/* filename of the issuer certificate   */</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *request_file;   <span class="comment">/* filename of the certificate request  */</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *subject_key;    <span class="comment">/* filename of the subject key file     */</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *issuer_key;     <span class="comment">/* filename of the issuer key file      */</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *subject_pwd;    <span class="comment">/* password for the subject key file    */</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *issuer_pwd;     <span class="comment">/* password for the issuer key file     */</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *output_file;    <span class="comment">/* where to store the constructed key file  */</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *subject_name;   <span class="comment">/* subject name for certificate         */</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *issuer_name;    <span class="comment">/* issuer name for certificate          */</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *not_before;     <span class="comment">/* validity period not before           */</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *not_after;      <span class="comment">/* validity period not after            */</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *serial;         <span class="comment">/* serial number string                 */</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordtype">int</span> selfsign;               <span class="comment">/* selfsign the certificate             */</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordtype">int</span> is_ca;                  <span class="comment">/* is a CA certificate                  */</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordtype">int</span> max_pathlen;            <span class="comment">/* maximum CA path length               */</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> key_usage;    <span class="comment">/* key usage flags                      */</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ns_cert_type; <span class="comment">/* NS cert type                         */</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;} opt;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keywordtype">int</span> write_certificate( <a class="code" href="structmbedtls__x509write__cert.html">mbedtls_x509write_cert</a> *crt, <span class="keyword">const</span> <span class="keywordtype">char</span> *output_file,</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                       <span class="keywordtype">int</span> (*f_rng)(<span class="keywordtype">void</span> *, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *, <span class="keywordtype">size_t</span>),</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                       <span class="keywordtype">void</span> *p_rng )</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;{</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    FILE *f;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> output_buf[4096];</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordtype">size_t</span> len = 0;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    memset( output_buf, 0, 4096 );</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="x509__crt_8h.html#a2b1106722175cf04ef07313626728886">mbedtls_x509write_crt_pem</a>( crt, output_buf, 4096, f_rng, p_rng ) ) &lt; 0 )</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">return</span>( ret );</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    len = strlen( (<span class="keywordtype">char</span> *) output_buf );</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">if</span>( ( f = fopen( output_file, <span class="stringliteral">&quot;w&quot;</span> ) ) == <a class="code" href="_s_e_g_g_e_r___r_t_t_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> )</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keywordflow">return</span>( -1 );</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span>( fwrite( output_buf, 1, len, f ) != len )</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    {</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        fclose( f );</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">return</span>( -1 );</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    fclose( f );</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;}</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="keywordtype">int</span> <a class="code" href="cert__write_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a>( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[] )</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;{</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="structmbedtls__x509__crt.html">mbedtls_x509_crt</a> issuer_crt;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="structmbedtls__pk__context.html">mbedtls_pk_context</a> loaded_issuer_key, loaded_subject_key;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="structmbedtls__pk__context.html">mbedtls_pk_context</a> *issuer_key = &amp;loaded_issuer_key,</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                *subject_key = &amp;loaded_subject_key;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">char</span> buf[1024];</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">char</span> issuer_name[256];</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">char</span> *p, *q, *r;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_X509_CSR_PARSE_C)</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordtype">char</span> subject_name[256];</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="structmbedtls__x509__csr.html">mbedtls_x509_csr</a> csr;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="structmbedtls__x509write__cert.html">mbedtls_x509write_cert</a> crt;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="structmbedtls__mpi.html">mbedtls_mpi</a> serial;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="structmbedtls__entropy__context.html">mbedtls_entropy_context</a> entropy;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="structmbedtls__ctr__drbg__context.html">mbedtls_ctr_drbg_context</a> ctr_drbg;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *pers = <span class="stringliteral">&quot;crt example app&quot;</span>;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">     * Set to sane values</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="x509__crt_8h.html#a9da6bf87b583e0eea76bc3ca21a1f3dd">mbedtls_x509write_crt_init</a>( &amp;crt );</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="x509__crt_8h.html#abdb1cdce6c47b3e697258279bb0e8715">mbedtls_x509write_crt_set_md_alg</a>( &amp;crt, <a class="code" href="md_8h.html#a219313cb40503ec3e34a857ab98b2296a7634aa1a264b0e1a5ec65f4ed77468f8">MBEDTLS_MD_SHA256</a> );</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="pk_8h.html#a999d1160bb30c03d0c4382c3a9b0aa89">mbedtls_pk_init</a>( &amp;loaded_issuer_key );</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="pk_8h.html#a999d1160bb30c03d0c4382c3a9b0aa89">mbedtls_pk_init</a>( &amp;loaded_subject_key );</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="bignum_8h.html#a99c7cca612b47dc4f3b96905c4f9d69e">mbedtls_mpi_init</a>( &amp;serial );</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="ctr__drbg_8h.html#a70dbec5e03601bf437ec488f2645743b">mbedtls_ctr_drbg_init</a>( &amp;ctr_drbg );</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_X509_CSR_PARSE_C)</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="group__x509__module.html#ga984db025f6953ea61be7dfca2d928f37">mbedtls_x509_csr_init</a>( &amp;csr );</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="group__x509__module.html#ga016dd06bc770e77b84005f305df20ed1">mbedtls_x509_crt_init</a>( &amp;issuer_crt );</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    memset( buf, 0, 1024 );</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">if</span>( argc == 0 )</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    usage:</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <a class="code" href="aescrypt2_8c.html#a56fe9bff0a1be75aae2da3e593053e2c">USAGE</a> );</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        ret = 1;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    opt.issuer_crt          = DFL_ISSUER_CRT;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    opt.request_file        = DFL_REQUEST_FILE;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    opt.subject_key         = DFL_SUBJECT_KEY;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    opt.issuer_key          = DFL_ISSUER_KEY;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    opt.subject_pwd         = DFL_SUBJECT_PWD;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    opt.issuer_pwd          = DFL_ISSUER_PWD;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    opt.output_file         = <a class="code" href="key__app__writer_8c.html#a63119d4a849bfda6c0701a6ec9c20b68">DFL_OUTPUT_FILENAME</a>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    opt.subject_name        = DFL_SUBJECT_NAME;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    opt.issuer_name         = DFL_ISSUER_NAME;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    opt.not_before          = DFL_NOT_BEFORE;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    opt.not_after           = DFL_NOT_AFTER;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    opt.serial              = DFL_SERIAL;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    opt.selfsign            = DFL_SELFSIGN;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    opt.is_ca               = DFL_IS_CA;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    opt.max_pathlen         = DFL_MAX_PATHLEN;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    opt.key_usage           = DFL_KEY_USAGE;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    opt.ns_cert_type        = DFL_NS_CERT_TYPE;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">for</span>( i = 1; i &lt; argc; i++ )</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        p = argv[i];</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">if</span>( ( q = strchr( p, <span class="charliteral">&#39;=&#39;</span> ) ) == <a class="code" href="_s_e_g_g_e_r___r_t_t_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> )</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="keywordflow">goto</span> usage;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        *q++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;request_file&quot;</span> ) == 0 )</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            opt.request_file = q;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;subject_key&quot;</span> ) == 0 )</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            opt.subject_key = q;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;issuer_key&quot;</span> ) == 0 )</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            opt.issuer_key = q;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;subject_pwd&quot;</span> ) == 0 )</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            opt.subject_pwd = q;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;issuer_pwd&quot;</span> ) == 0 )</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            opt.issuer_pwd = q;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;issuer_crt&quot;</span> ) == 0 )</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            opt.issuer_crt = q;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;output_file&quot;</span> ) == 0 )</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            opt.output_file = q;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;subject_name&quot;</span> ) == 0 )</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            opt.subject_name = q;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;issuer_name&quot;</span> ) == 0 )</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            opt.issuer_name = q;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;not_before&quot;</span> ) == 0 )</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            opt.not_before = q;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;not_after&quot;</span> ) == 0 )</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            opt.not_after = q;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;serial&quot;</span> ) == 0 )</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            opt.serial = q;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;selfsign&quot;</span> ) == 0 )</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            opt.selfsign = atoi( q );</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <span class="keywordflow">if</span>( opt.selfsign &lt; 0 || opt.selfsign &gt; 1 )</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                <span class="keywordflow">goto</span> usage;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;is_ca&quot;</span> ) == 0 )</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            opt.is_ca = atoi( q );</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="keywordflow">if</span>( opt.is_ca &lt; 0 || opt.is_ca &gt; 1 )</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                <span class="keywordflow">goto</span> usage;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;max_pathlen&quot;</span> ) == 0 )</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            opt.max_pathlen = atoi( q );</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordflow">if</span>( opt.max_pathlen &lt; -1 || opt.max_pathlen &gt; 127 )</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                <span class="keywordflow">goto</span> usage;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;key_usage&quot;</span> ) == 0 )</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keywordflow">while</span>( q != <a class="code" href="_s_e_g_g_e_r___r_t_t_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> )</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                <span class="keywordflow">if</span>( ( r = strchr( q, <span class="charliteral">&#39;,&#39;</span> ) ) != <a class="code" href="_s_e_g_g_e_r___r_t_t_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> )</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    *r++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                <span class="keywordflow">if</span>( strcmp( q, <span class="stringliteral">&quot;digital_signature&quot;</span> ) == 0 )</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                    opt.key_usage |= <a class="code" href="x509_8h.html#a2d4212e9f556d819dcf18ada06a22101">MBEDTLS_X509_KU_DIGITAL_SIGNATURE</a>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( q, <span class="stringliteral">&quot;non_repudiation&quot;</span> ) == 0 )</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                    opt.key_usage |= <a class="code" href="x509_8h.html#ab2e4125f34eb6332cca653eccc8a1993">MBEDTLS_X509_KU_NON_REPUDIATION</a>;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( q, <span class="stringliteral">&quot;key_encipherment&quot;</span> ) == 0 )</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    opt.key_usage |= <a class="code" href="x509_8h.html#ad7e93b186781f0474f8662fb2a83c370">MBEDTLS_X509_KU_KEY_ENCIPHERMENT</a>;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( q, <span class="stringliteral">&quot;data_encipherment&quot;</span> ) == 0 )</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                    opt.key_usage |= <a class="code" href="x509_8h.html#ad3c4beaae071ce4418697df9c0950021">MBEDTLS_X509_KU_DATA_ENCIPHERMENT</a>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( q, <span class="stringliteral">&quot;key_agreement&quot;</span> ) == 0 )</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                    opt.key_usage |= <a class="code" href="x509_8h.html#abce173357d84bc4597b12952a193011c">MBEDTLS_X509_KU_KEY_AGREEMENT</a>;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( q, <span class="stringliteral">&quot;key_cert_sign&quot;</span> ) == 0 )</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                    opt.key_usage |= <a class="code" href="x509_8h.html#a6937b6cde9a8a30a3967b6c2288e9d2d">MBEDTLS_X509_KU_KEY_CERT_SIGN</a>;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( q, <span class="stringliteral">&quot;crl_sign&quot;</span> ) == 0 )</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                    opt.key_usage |= <a class="code" href="x509_8h.html#a9a361131f89cd27e19449c991705c0f3">MBEDTLS_X509_KU_CRL_SIGN</a>;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                    <span class="keywordflow">goto</span> usage;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                q = r;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            }</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( p, <span class="stringliteral">&quot;ns_cert_type&quot;</span> ) == 0 )</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="keywordflow">while</span>( q != <a class="code" href="_s_e_g_g_e_r___r_t_t_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> )</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                <span class="keywordflow">if</span>( ( r = strchr( q, <span class="charliteral">&#39;,&#39;</span> ) ) != <a class="code" href="_s_e_g_g_e_r___r_t_t_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> )</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                    *r++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                <span class="keywordflow">if</span>( strcmp( q, <span class="stringliteral">&quot;ssl_client&quot;</span> ) == 0 )</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                    opt.ns_cert_type |= <a class="code" href="x509_8h.html#a379c1cbfec75822feb6ab8dd470f2f5f">MBEDTLS_X509_NS_CERT_TYPE_SSL_CLIENT</a>;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( q, <span class="stringliteral">&quot;ssl_server&quot;</span> ) == 0 )</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                    opt.ns_cert_type |= <a class="code" href="x509_8h.html#a632958cb9a2a77af495536a40e1b9fef">MBEDTLS_X509_NS_CERT_TYPE_SSL_SERVER</a>;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( q, <span class="stringliteral">&quot;email&quot;</span> ) == 0 )</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    opt.ns_cert_type |= <a class="code" href="x509_8h.html#a435813d11986e4ffc168e13637b66f26">MBEDTLS_X509_NS_CERT_TYPE_EMAIL</a>;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( q, <span class="stringliteral">&quot;object_signing&quot;</span> ) == 0 )</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                    opt.ns_cert_type |= <a class="code" href="x509_8h.html#a0dc99e9a29593ae1ab51361870b5e555">MBEDTLS_X509_NS_CERT_TYPE_OBJECT_SIGNING</a>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( q, <span class="stringliteral">&quot;ssl_ca&quot;</span> ) == 0 )</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                    opt.ns_cert_type |= <a class="code" href="x509_8h.html#a831422b2f74283a90bf6f2e88113b5f8">MBEDTLS_X509_NS_CERT_TYPE_SSL_CA</a>;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( q, <span class="stringliteral">&quot;email_ca&quot;</span> ) == 0 )</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    opt.ns_cert_type |= <a class="code" href="x509_8h.html#a11036f8e61fb3a5433508720360c8bfa">MBEDTLS_X509_NS_CERT_TYPE_EMAIL_CA</a>;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( strcmp( q, <span class="stringliteral">&quot;object_signing_ca&quot;</span> ) == 0 )</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                    opt.ns_cert_type |= <a class="code" href="x509_8h.html#a178dff35633f812860ff7abe7898a8a8">MBEDTLS_X509_NS_CERT_TYPE_OBJECT_SIGNING_CA</a>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                    <span class="keywordflow">goto</span> usage;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                q = r;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keywordflow">goto</span> usage;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">     * 0. Seed the PRNG</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . Seeding the random number generator...&quot;</span> );</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    fflush( stdout );</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="entropy_8h.html#aa901e027093c6fe65dee5760db78aced">mbedtls_entropy_init</a>( &amp;entropy );</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="ctr__drbg_8h.html#ad93d675f998550b4478c1fe6f4f34ebc">mbedtls_ctr_drbg_seed</a>( &amp;ctr_drbg, <a class="code" href="entropy_8h.html#a81765f6cdf4e5111bcb9f4324f3234cb">mbedtls_entropy_func</a>, &amp;entropy,</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                               (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) pers,</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                               strlen( pers ) ) ) != 0 )</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_ctr_drbg_seed returned %d - %s\n&quot;</span>, ret, buf );</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok\n&quot;</span> );</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">// Parse serial to MPI</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . Reading serial number...&quot;</span> );</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    fflush( stdout );</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="bignum_8h.html#a15efd3f2f86700b69f6c18d34ac05758">mbedtls_mpi_read_string</a>( &amp;serial, 10, opt.serial ) ) != 0 )</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_mpi_read_string returned -0x%02x - %s\n\n&quot;</span>, -ret, buf );</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok\n&quot;</span> );</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">// Parse issuer certificate if present</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">if</span>( !opt.selfsign &amp;&amp; strlen( opt.issuer_crt ) )</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">         * 1.0.a. Load the certificates</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . Loading the issuer certificate ...&quot;</span> );</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        fflush( stdout );</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">if</span>( ( ret = <a class="code" href="group__x509__module.html#gad4da63133d3590aa311488497d4c38ec">mbedtls_x509_crt_parse_file</a>( &amp;issuer_crt, opt.issuer_crt ) ) != 0 )</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        {</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509_crt_parse_file returned -0x%02x - %s\n\n&quot;</span>, -ret, buf );</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        ret = <a class="code" href="x509_8h.html#a576f34a7432238db229137bdfc3cfde0">mbedtls_x509_dn_gets</a>( issuer_name, <span class="keyword">sizeof</span>(issuer_name),</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                 &amp;issuer_crt.<a class="code" href="structmbedtls__x509__crt.html#a7a0c0b511d5f2eda5a5dab75cca51441">subject</a> );</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordflow">if</span>( ret &lt; 0 )</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509_dn_gets returned -0x%02x - %s\n\n&quot;</span>, -ret, buf );</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        opt.issuer_name = issuer_name;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok\n&quot;</span> );</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    }</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_X509_CSR_PARSE_C)</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// Parse certificate request if present</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">if</span>( !opt.selfsign &amp;&amp; strlen( opt.request_file ) )</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">         * 1.0.b. Load the CSR</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . Loading the certificate request ...&quot;</span> );</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        fflush( stdout );</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">if</span>( ( ret = <a class="code" href="group__x509__module.html#gaf49db7323eee45d9649600de18d715f8">mbedtls_x509_csr_parse_file</a>( &amp;csr, opt.request_file ) ) != 0 )</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509_csr_parse_file returned -0x%02x - %s\n\n&quot;</span>, -ret, buf );</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        ret = <a class="code" href="x509_8h.html#a576f34a7432238db229137bdfc3cfde0">mbedtls_x509_dn_gets</a>( subject_name, <span class="keyword">sizeof</span>(subject_name),</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                                 &amp;csr.<a class="code" href="structmbedtls__x509__csr.html#a7a0c0b511d5f2eda5a5dab75cca51441">subject</a> );</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">if</span>( ret &lt; 0 )</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        {</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509_dn_gets returned -0x%02x - %s\n\n&quot;</span>, -ret, buf );</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        }</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        opt.subject_name = subject_name;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        subject_key = &amp;csr.<a class="code" href="structmbedtls__x509__csr.html#a6a0158fab362fa830848b1bc5dff7da4">pk</a>;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok\n&quot;</span> );</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_X509_CSR_PARSE_C */</span><span class="preprocessor"></span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">     * 1.1. Load the keys</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">if</span>( !opt.selfsign &amp;&amp; !strlen( opt.request_file ) )</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    {</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . Loading the subject key ...&quot;</span> );</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        fflush( stdout );</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        ret = <a class="code" href="pk_8h.html#a935d710e542409462d0209f2381da83e">mbedtls_pk_parse_keyfile</a>( &amp;loaded_subject_key, opt.subject_key,</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                 opt.subject_pwd );</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="keywordflow">if</span>( ret != 0 )</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        {</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_pk_parse_keyfile returned -0x%02x - %s\n\n&quot;</span>, -ret, buf );</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        }</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok\n&quot;</span> );</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . Loading the issuer key ...&quot;</span> );</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    fflush( stdout );</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    ret = <a class="code" href="pk_8h.html#a935d710e542409462d0209f2381da83e">mbedtls_pk_parse_keyfile</a>( &amp;loaded_issuer_key, opt.issuer_key,</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                             opt.issuer_pwd );</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">if</span>( ret != 0 )</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    {</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_pk_parse_keyfile returned -x%02x - %s\n\n&quot;</span>, -ret, buf );</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    }</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">// Check if key and issuer certificate match</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">if</span>( strlen( opt.issuer_crt ) )</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordflow">if</span>( !<a class="code" href="pk_8h.html#a2d72c66f5e78abe153bdf08874aaabf6">mbedtls_pk_can_do</a>( &amp;issuer_crt.<a class="code" href="structmbedtls__x509__crt.html#a6a0158fab362fa830848b1bc5dff7da4">pk</a>, <a class="code" href="pk_8h.html#a3fe41eff5605ae727eb9d28dad297020ac4fd7ca431c2e748df4ed0a324dd58c5">MBEDTLS_PK_RSA</a> ) ||</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <a class="code" href="bignum_8h.html#a762dd8add46384d4935a4aecc125096e">mbedtls_mpi_cmp_mpi</a>( &amp;mbedtls_pk_rsa( issuer_crt.<a class="code" href="structmbedtls__x509__crt.html#a6a0158fab362fa830848b1bc5dff7da4">pk</a> )-&gt;N,</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                         &amp;mbedtls_pk_rsa( *issuer_key )-&gt;N ) != 0 ||</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <a class="code" href="bignum_8h.html#a762dd8add46384d4935a4aecc125096e">mbedtls_mpi_cmp_mpi</a>( &amp;mbedtls_pk_rsa( issuer_crt.<a class="code" href="structmbedtls__x509__crt.html#a6a0158fab362fa830848b1bc5dff7da4">pk</a> )-&gt;E,</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                         &amp;mbedtls_pk_rsa( *issuer_key )-&gt;E ) != 0 )</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        {</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  issuer_key does not match issuer certificate\n\n&quot;</span> );</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            ret = -1;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    }</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok\n&quot;</span> );</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">if</span>( opt.selfsign )</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        opt.subject_name = opt.issuer_name;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        subject_key = issuer_key;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="x509__crt_8h.html#a110c19b1d4379efa650a7e431276f9b0">mbedtls_x509write_crt_set_subject_key</a>( &amp;crt, subject_key );</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <a class="code" href="x509__crt_8h.html#a416f26146d68bb79aac90e8e48bbe7df">mbedtls_x509write_crt_set_issuer_key</a>( &amp;crt, issuer_key );</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">     * 1.0. Check the names for validity</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="x509__crt_8h.html#a272798b488a8ad984c4db95142392ba6">mbedtls_x509write_crt_set_subject_name</a>( &amp;crt, opt.subject_name ) ) != 0 )</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    {</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509write_crt_set_subject_name returned -0x%02x - %s\n\n&quot;</span>, -ret, buf );</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="x509__crt_8h.html#a5378017315ad6ac4da70f07777259e19">mbedtls_x509write_crt_set_issuer_name</a>( &amp;crt, opt.issuer_name ) ) != 0 )</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509write_crt_set_issuer_name returned -0x%02x - %s\n\n&quot;</span>, -ret, buf );</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    }</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . Setting certificate values ...&quot;</span> );</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    fflush( stdout );</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    ret = <a class="code" href="x509__crt_8h.html#a32c8ac687c84d8066213297e6813c2f0">mbedtls_x509write_crt_set_serial</a>( &amp;crt, &amp;serial );</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordflow">if</span>( ret != 0 )</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509write_crt_set_serial returned -0x%02x - %s\n\n&quot;</span>, -ret, buf );</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    ret = <a class="code" href="x509__crt_8h.html#ac7f9ece75e647023a0411a7bfa72b9f1">mbedtls_x509write_crt_set_validity</a>( &amp;crt, opt.<a class="code" href="structmbedtls__x509write__cert.html#a04f54cf981e4c883878068c8086ab233">not_before</a>, opt.not_after );</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">if</span>( ret != 0 )</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    {</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509write_crt_set_validity returned -0x%02x - %s\n\n&quot;</span>, -ret, buf );</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok\n&quot;</span> );</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . Adding the Basic Constraints extension ...&quot;</span> );</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    fflush( stdout );</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    ret = <a class="code" href="x509__crt_8h.html#ae13aefe1e123dcbcefe1eccd7968b6d2">mbedtls_x509write_crt_set_basic_constraints</a>( &amp;crt, opt.is_ca,</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                               opt.max_pathlen );</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">if</span>( ret != 0 )</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  x509write_crt_set_basic_contraints returned -0x%02x - %s\n\n&quot;</span>, -ret, buf );</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    }</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok\n&quot;</span> );</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_SHA1_C)</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . Adding the Subject Key Identifier ...&quot;</span> );</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    fflush( stdout );</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    ret = <a class="code" href="x509__crt_8h.html#a09dd1d818f15b9655f5dbcd3d7c1ec0f">mbedtls_x509write_crt_set_subject_key_identifier</a>( &amp;crt );</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">if</span>( ret != 0 )</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    {</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509write_crt_set_subject_key_identifier returned -0x%02x - %s\n\n&quot;</span>, -ret, buf );</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    }</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok\n&quot;</span> );</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . Adding the Authority Key Identifier ...&quot;</span> );</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    fflush( stdout );</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    ret = <a class="code" href="x509__crt_8h.html#a7e43c8a91bdd1f5c0b8f729ef602b624">mbedtls_x509write_crt_set_authority_key_identifier</a>( &amp;crt );</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">if</span>( ret != 0 )</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    {</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509write_crt_set_authority_key_identifier returned -0x%02x - %s\n\n&quot;</span>, -ret, buf );</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok\n&quot;</span> );</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_SHA1_C */</span><span class="preprocessor"></span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">if</span>( opt.key_usage )</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    {</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . Adding the Key Usage extension ...&quot;</span> );</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        fflush( stdout );</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        ret = <a class="code" href="x509__crt_8h.html#a5ce0db5d77fe07074601c585fe63089a">mbedtls_x509write_crt_set_key_usage</a>( &amp;crt, opt.key_usage );</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="keywordflow">if</span>( ret != 0 )</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509write_crt_set_key_usage returned -0x%02x - %s\n\n&quot;</span>, -ret, buf );</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        }</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok\n&quot;</span> );</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    }</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordflow">if</span>( opt.ns_cert_type )</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . Adding the NS Cert Type extension ...&quot;</span> );</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        fflush( stdout );</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        ret = <a class="code" href="x509__crt_8h.html#a62f8e6d643c142c87662655bcfc7c7a5">mbedtls_x509write_crt_set_ns_cert_type</a>( &amp;crt, opt.ns_cert_type );</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">if</span>( ret != 0 )</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        {</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  mbedtls_x509write_crt_set_ns_cert_type returned -0x%02x - %s\n\n&quot;</span>, -ret, buf );</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        }</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok\n&quot;</span> );</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    }</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">     * 1.2. Writing the request</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  . Writing the certificate...&quot;</span> );</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    fflush( stdout );</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">if</span>( ( ret = write_certificate( &amp;crt, opt.output_file,</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                                   <a class="code" href="ctr__drbg_8h.html#af6e4dd295ae790a33128562dd01c79ab">mbedtls_ctr_drbg_random</a>, &amp;ctr_drbg ) ) != 0 )</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <a class="code" href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a>( ret, buf, 1024 );</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; failed\n  !  write_certifcate -0x%02x - %s\n\n&quot;</span>, -ret, buf );</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    }</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot; ok\n&quot;</span> );</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;exit:</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <a class="code" href="x509__crt_8h.html#aacd2986253f977770c2353a54cf2e670">mbedtls_x509write_crt_free</a>( &amp;crt );</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <a class="code" href="pk_8h.html#ac6a9786d96abfd73c4dff6814238feb9">mbedtls_pk_free</a>( &amp;loaded_subject_key );</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <a class="code" href="pk_8h.html#ac6a9786d96abfd73c4dff6814238feb9">mbedtls_pk_free</a>( &amp;loaded_issuer_key );</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <a class="code" href="bignum_8h.html#abffd5d8382cb86c089a1ef2bebb90f9f">mbedtls_mpi_free</a>( &amp;serial );</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <a class="code" href="ctr__drbg_8h.html#a1ea42b9eb6f6b33c82359f4c0a57ca43">mbedtls_ctr_drbg_free</a>( &amp;ctr_drbg );</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <a class="code" href="entropy_8h.html#a06778439f8a0e2daa2d3b444e06ad8dd">mbedtls_entropy_free</a>( &amp;entropy );</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="preprocessor">#if defined(_WIN32)</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <a class="code" href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a>( <span class="stringliteral">&quot;  + Press Enter to exit this program.\n&quot;</span> );</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    fflush( stdout ); getchar();</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordflow">return</span>( ret );</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;}</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_X509_CRT_WRITE_C &amp;&amp; MBEDTLS_X509_CRT_PARSE_C &amp;&amp;</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">          MBEDTLS_FS_IO &amp;&amp; MBEDTLS_ENTROPY_C &amp;&amp; MBEDTLS_CTR_DRBG_C &amp;&amp;</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">          MBEDTLS_ERROR_C &amp;&amp; MBEDTLS_PEM_WRITE_C */</span><span class="preprocessor"></span></div><div class="ttc" id="bignum_8h_html_abffd5d8382cb86c089a1ef2bebb90f9f"><div class="ttname"><a href="bignum_8h.html#abffd5d8382cb86c089a1ef2bebb90f9f">mbedtls_mpi_free</a></div><div class="ttdeci">void mbedtls_mpi_free(mbedtls_mpi *X)</div><div class="ttdoc">Unallocate one MPI. </div></div>
<div class="ttc" id="structmbedtls__x509__csr_html"><div class="ttname"><a href="structmbedtls__x509__csr.html">mbedtls_x509_csr</a></div><div class="ttdef"><b>Definition:</b> <a href="x509__csr_8h_source.html#l00050">x509_csr.h:50</a></div></div>
<div class="ttc" id="x509__crt_8h_html_a7e43c8a91bdd1f5c0b8f729ef602b624"><div class="ttname"><a href="x509__crt_8h.html#a7e43c8a91bdd1f5c0b8f729ef602b624">mbedtls_x509write_crt_set_authority_key_identifier</a></div><div class="ttdeci">int mbedtls_x509write_crt_set_authority_key_identifier(mbedtls_x509write_cert *ctx)</div><div class="ttdoc">Set the authorityKeyIdentifier extension for a CRT Requires that mbedtls_x509write_crt_set_issuer_key...</div></div>
<div class="ttc" id="structmbedtls__ctr__drbg__context_html"><div class="ttname"><a href="structmbedtls__ctr__drbg__context.html">mbedtls_ctr_drbg_context</a></div><div class="ttdoc">CTR_DRBG context structure. </div><div class="ttdef"><b>Definition:</b> <a href="ctr__drbg_8h_source.html#l00087">ctr_drbg.h:87</a></div></div>
<div class="ttc" id="aescrypt2_8c_html_a56fe9bff0a1be75aae2da3e593053e2c"><div class="ttname"><a href="aescrypt2_8c.html#a56fe9bff0a1be75aae2da3e593053e2c">USAGE</a></div><div class="ttdeci">#define USAGE</div><div class="ttdef"><b>Definition:</b> <a href="aescrypt2_8c_source.html#l00056">aescrypt2.c:56</a></div></div>
<div class="ttc" id="structmbedtls__pk__context_html"><div class="ttname"><a href="structmbedtls__pk__context.html">mbedtls_pk_context</a></div><div class="ttdoc">Public key container. </div><div class="ttdef"><b>Definition:</b> <a href="pk_8h_source.html#l00126">pk.h:126</a></div></div>
<div class="ttc" id="ctr__drbg_8h_html_a1ea42b9eb6f6b33c82359f4c0a57ca43"><div class="ttname"><a href="ctr__drbg_8h.html#a1ea42b9eb6f6b33c82359f4c0a57ca43">mbedtls_ctr_drbg_free</a></div><div class="ttdeci">void mbedtls_ctr_drbg_free(mbedtls_ctr_drbg_context *ctx)</div><div class="ttdoc">Clear CTR_CRBG context data. </div></div>
<div class="ttc" id="pk_8h_html_a999d1160bb30c03d0c4382c3a9b0aa89"><div class="ttname"><a href="pk_8h.html#a999d1160bb30c03d0c4382c3a9b0aa89">mbedtls_pk_init</a></div><div class="ttdeci">void mbedtls_pk_init(mbedtls_pk_context *ctx)</div><div class="ttdoc">Initialize a mbedtls_pk_context (as NONE) </div></div>
<div class="ttc" id="pk_8h_html_a2d72c66f5e78abe153bdf08874aaabf6"><div class="ttname"><a href="pk_8h.html#a2d72c66f5e78abe153bdf08874aaabf6">mbedtls_pk_can_do</a></div><div class="ttdeci">int mbedtls_pk_can_do(const mbedtls_pk_context *ctx, mbedtls_pk_type_t type)</div><div class="ttdoc">Tell if a context can do the operation given by type. </div></div>
<div class="ttc" id="x509_8h_html_a9a361131f89cd27e19449c991705c0f3"><div class="ttname"><a href="x509_8h.html#a9a361131f89cd27e19449c991705c0f3">MBEDTLS_X509_KU_CRL_SIGN</a></div><div class="ttdeci">#define MBEDTLS_X509_KU_CRL_SIGN</div><div class="ttdef"><b>Definition:</b> <a href="x509_8h_source.html#l00120">x509.h:120</a></div></div>
<div class="ttc" id="error_8h_html_a8c41c149b77a4807115b19c2af858558"><div class="ttname"><a href="error_8h.html#a8c41c149b77a4807115b19c2af858558">mbedtls_strerror</a></div><div class="ttdeci">void mbedtls_strerror(int errnum, char *buffer, size_t buflen)</div><div class="ttdoc">Translate a mbed TLS error code into a string representation, Result is truncated if necessary and al...</div></div>
<div class="ttc" id="ctr__drbg_8h_html_a70dbec5e03601bf437ec488f2645743b"><div class="ttname"><a href="ctr__drbg_8h.html#a70dbec5e03601bf437ec488f2645743b">mbedtls_ctr_drbg_init</a></div><div class="ttdeci">void mbedtls_ctr_drbg_init(mbedtls_ctr_drbg_context *ctx)</div><div class="ttdoc">CTR_DRBG context initialization Makes the context ready for mbedtls_ctr_drbg_seed() or mbedtls_ctr_dr...</div></div>
<div class="ttc" id="group__x509__module_html_gaf49db7323eee45d9649600de18d715f8"><div class="ttname"><a href="group__x509__module.html#gaf49db7323eee45d9649600de18d715f8">mbedtls_x509_csr_parse_file</a></div><div class="ttdeci">int mbedtls_x509_csr_parse_file(mbedtls_x509_csr *csr, const char *path)</div><div class="ttdoc">Load a Certificate Signing Request (CSR) </div></div>
<div class="ttc" id="bignum_8h_html_a762dd8add46384d4935a4aecc125096e"><div class="ttname"><a href="bignum_8h.html#a762dd8add46384d4935a4aecc125096e">mbedtls_mpi_cmp_mpi</a></div><div class="ttdeci">int mbedtls_mpi_cmp_mpi(const mbedtls_mpi *X, const mbedtls_mpi *Y)</div><div class="ttdoc">Compare signed values. </div></div>
<div class="ttc" id="x509_8h_html_a379c1cbfec75822feb6ab8dd470f2f5f"><div class="ttname"><a href="x509_8h.html#a379c1cbfec75822feb6ab8dd470f2f5f">MBEDTLS_X509_NS_CERT_TYPE_SSL_CLIENT</a></div><div class="ttdeci">#define MBEDTLS_X509_NS_CERT_TYPE_SSL_CLIENT</div><div class="ttdef"><b>Definition:</b> <a href="x509_8h_source.html#l00129">x509.h:129</a></div></div>
<div class="ttc" id="x509__crt_8h_html_a62f8e6d643c142c87662655bcfc7c7a5"><div class="ttname"><a href="x509__crt_8h.html#a62f8e6d643c142c87662655bcfc7c7a5">mbedtls_x509write_crt_set_ns_cert_type</a></div><div class="ttdeci">int mbedtls_x509write_crt_set_ns_cert_type(mbedtls_x509write_cert *ctx, unsigned char ns_cert_type)</div><div class="ttdoc">Set the Netscape Cert Type flags (e.g. MBEDTLS_X509_NS_CERT_TYPE_SSL_CLIENT | MBEDTLS_X509_NS_CERT_TY...</div></div>
<div class="ttc" id="config_8h_html"><div class="ttname"><a href="config_8h.html">config.h</a></div><div class="ttdoc">Configuration options (set of defines) </div></div>
<div class="ttc" id="ctr__drbg_8h_html_af6e4dd295ae790a33128562dd01c79ab"><div class="ttname"><a href="ctr__drbg_8h.html#af6e4dd295ae790a33128562dd01c79ab">mbedtls_ctr_drbg_random</a></div><div class="ttdeci">int mbedtls_ctr_drbg_random(void *p_rng, unsigned char *output, size_t output_len)</div><div class="ttdoc">CTR_DRBG generate random. </div></div>
<div class="ttc" id="x509_8h_html_a2d4212e9f556d819dcf18ada06a22101"><div class="ttname"><a href="x509_8h.html#a2d4212e9f556d819dcf18ada06a22101">MBEDTLS_X509_KU_DIGITAL_SIGNATURE</a></div><div class="ttdeci">#define MBEDTLS_X509_KU_DIGITAL_SIGNATURE</div><div class="ttdef"><b>Definition:</b> <a href="x509_8h_source.html#l00114">x509.h:114</a></div></div>
<div class="ttc" id="x509__crt_8h_html_a2b1106722175cf04ef07313626728886"><div class="ttname"><a href="x509__crt_8h.html#a2b1106722175cf04ef07313626728886">mbedtls_x509write_crt_pem</a></div><div class="ttdeci">int mbedtls_x509write_crt_pem(mbedtls_x509write_cert *ctx, unsigned char *buf, size_t size, int(*f_rng)(void *, unsigned char *, size_t), void *p_rng)</div><div class="ttdoc">Write a built up certificate to a X509 PEM string. </div></div>
<div class="ttc" id="bignum_8h_html_a15efd3f2f86700b69f6c18d34ac05758"><div class="ttname"><a href="bignum_8h.html#a15efd3f2f86700b69f6c18d34ac05758">mbedtls_mpi_read_string</a></div><div class="ttdeci">int mbedtls_mpi_read_string(mbedtls_mpi *X, int radix, const char *s)</div><div class="ttdoc">Import from an ASCII string. </div></div>
<div class="ttc" id="structmbedtls__x509__csr_html_a6a0158fab362fa830848b1bc5dff7da4"><div class="ttname"><a href="structmbedtls__x509__csr.html#a6a0158fab362fa830848b1bc5dff7da4">mbedtls_x509_csr::pk</a></div><div class="ttdeci">mbedtls_pk_context pk</div><div class="ttdef"><b>Definition:</b> <a href="x509__csr_8h_source.html#l00060">x509_csr.h:60</a></div></div>
<div class="ttc" id="entropy_8h_html_aa901e027093c6fe65dee5760db78aced"><div class="ttname"><a href="entropy_8h.html#aa901e027093c6fe65dee5760db78aced">mbedtls_entropy_init</a></div><div class="ttdeci">void mbedtls_entropy_init(mbedtls_entropy_context *ctx)</div><div class="ttdoc">Initialize the context. </div></div>
<div class="ttc" id="x509__crt_8h_html_a110c19b1d4379efa650a7e431276f9b0"><div class="ttname"><a href="x509__crt_8h.html#a110c19b1d4379efa650a7e431276f9b0">mbedtls_x509write_crt_set_subject_key</a></div><div class="ttdeci">void mbedtls_x509write_crt_set_subject_key(mbedtls_x509write_cert *ctx, mbedtls_pk_context *key)</div><div class="ttdoc">Set the subject public key for the certificate. </div></div>
<div class="ttc" id="x509__crt_8h_html_a5ce0db5d77fe07074601c585fe63089a"><div class="ttname"><a href="x509__crt_8h.html#a5ce0db5d77fe07074601c585fe63089a">mbedtls_x509write_crt_set_key_usage</a></div><div class="ttdeci">int mbedtls_x509write_crt_set_key_usage(mbedtls_x509write_cert *ctx, unsigned int key_usage)</div><div class="ttdoc">Set the Key Usage Extension flags (e.g. MBEDTLS_X509_KU_DIGITAL_SIGNATURE | MBEDTLS_X509_KU_KEY_CERT_...</div></div>
<div class="ttc" id="x509__crt_8h_html_a9da6bf87b583e0eea76bc3ca21a1f3dd"><div class="ttname"><a href="x509__crt_8h.html#a9da6bf87b583e0eea76bc3ca21a1f3dd">mbedtls_x509write_crt_init</a></div><div class="ttdeci">void mbedtls_x509write_crt_init(mbedtls_x509write_cert *ctx)</div><div class="ttdoc">Initialize a CRT writing context. </div></div>
<div class="ttc" id="entropy_8h_html"><div class="ttname"><a href="entropy_8h.html">entropy.h</a></div><div class="ttdoc">Entropy accumulator implementation. </div></div>
<div class="ttc" id="x509_8h_html_ab2e4125f34eb6332cca653eccc8a1993"><div class="ttname"><a href="x509_8h.html#ab2e4125f34eb6332cca653eccc8a1993">MBEDTLS_X509_KU_NON_REPUDIATION</a></div><div class="ttdeci">#define MBEDTLS_X509_KU_NON_REPUDIATION</div><div class="ttdef"><b>Definition:</b> <a href="x509_8h_source.html#l00115">x509.h:115</a></div></div>
<div class="ttc" id="cert__write_8c_html_a840291bc02cba5474a4cb46a9b9566fe"><div class="ttname"><a href="cert__write_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a></div><div class="ttdeci">int main(void)</div><div class="ttdef"><b>Definition:</b> <a href="cert__write_8c_source.html#l00040">cert_write.c:40</a></div></div>
<div class="ttc" id="x509__crt_8h_html_abdb1cdce6c47b3e697258279bb0e8715"><div class="ttname"><a href="x509__crt_8h.html#abdb1cdce6c47b3e697258279bb0e8715">mbedtls_x509write_crt_set_md_alg</a></div><div class="ttdeci">void mbedtls_x509write_crt_set_md_alg(mbedtls_x509write_cert *ctx, mbedtls_md_type_t md_alg)</div><div class="ttdoc">Set the MD algorithm to use for the signature (e.g. MBEDTLS_MD_SHA1) </div></div>
<div class="ttc" id="pk_8h_html_a3fe41eff5605ae727eb9d28dad297020ac4fd7ca431c2e748df4ed0a324dd58c5"><div class="ttname"><a href="pk_8h.html#a3fe41eff5605ae727eb9d28dad297020ac4fd7ca431c2e748df4ed0a324dd58c5">MBEDTLS_PK_RSA</a></div><div class="ttdef"><b>Definition:</b> <a href="pk_8h_source.html#l00076">pk.h:76</a></div></div>
<div class="ttc" id="structmbedtls__entropy__context_html"><div class="ttname"><a href="structmbedtls__entropy__context.html">mbedtls_entropy_context</a></div><div class="ttdoc">Entropy context structure. </div><div class="ttdef"><b>Definition:</b> <a href="entropy_8h_source.html#l00122">entropy.h:122</a></div></div>
<div class="ttc" id="x509__crt_8h_html_ae13aefe1e123dcbcefe1eccd7968b6d2"><div class="ttname"><a href="x509__crt_8h.html#ae13aefe1e123dcbcefe1eccd7968b6d2">mbedtls_x509write_crt_set_basic_constraints</a></div><div class="ttdeci">int mbedtls_x509write_crt_set_basic_constraints(mbedtls_x509write_cert *ctx, int is_ca, int max_pathlen)</div><div class="ttdoc">Set the basicConstraints extension for a CRT. </div></div>
<div class="ttc" id="error_8h_html"><div class="ttname"><a href="error_8h.html">error.h</a></div><div class="ttdoc">Error to string translation. </div></div>
<div class="ttc" id="x509_8h_html_a831422b2f74283a90bf6f2e88113b5f8"><div class="ttname"><a href="x509_8h.html#a831422b2f74283a90bf6f2e88113b5f8">MBEDTLS_X509_NS_CERT_TYPE_SSL_CA</a></div><div class="ttdeci">#define MBEDTLS_X509_NS_CERT_TYPE_SSL_CA</div><div class="ttdef"><b>Definition:</b> <a href="x509_8h_source.html#l00134">x509.h:134</a></div></div>
<div class="ttc" id="x509_8h_html_a11036f8e61fb3a5433508720360c8bfa"><div class="ttname"><a href="x509_8h.html#a11036f8e61fb3a5433508720360c8bfa">MBEDTLS_X509_NS_CERT_TYPE_EMAIL_CA</a></div><div class="ttdeci">#define MBEDTLS_X509_NS_CERT_TYPE_EMAIL_CA</div><div class="ttdef"><b>Definition:</b> <a href="x509_8h_source.html#l00135">x509.h:135</a></div></div>
<div class="ttc" id="entropy_8h_html_a81765f6cdf4e5111bcb9f4324f3234cb"><div class="ttname"><a href="entropy_8h.html#a81765f6cdf4e5111bcb9f4324f3234cb">mbedtls_entropy_func</a></div><div class="ttdeci">int mbedtls_entropy_func(void *data, unsigned char *output, size_t len)</div><div class="ttdoc">Retrieve entropy from the accumulator (Maximum length: MBEDTLS_ENTROPY_BLOCK_SIZE) (Thread-safe if MB...</div></div>
<div class="ttc" id="_s_e_g_g_e_r___r_t_t_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="_s_e_g_g_e_r___r_t_t_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="_s_e_g_g_e_r___r_t_t_8c_source.html#l00114">SEGGER_RTT.c:114</a></div></div>
<div class="ttc" id="structmbedtls__x509write__cert_html"><div class="ttname"><a href="structmbedtls__x509write__cert.html">mbedtls_x509write_cert</a></div><div class="ttdef"><b>Definition:</b> <a href="x509__crt_8h_source.html#l00130">x509_crt.h:130</a></div></div>
<div class="ttc" id="group__x509__module_html_ga984db025f6953ea61be7dfca2d928f37"><div class="ttname"><a href="group__x509__module.html#ga984db025f6953ea61be7dfca2d928f37">mbedtls_x509_csr_init</a></div><div class="ttdeci">void mbedtls_x509_csr_init(mbedtls_x509_csr *csr)</div><div class="ttdoc">Initialize a CSR. </div></div>
<div class="ttc" id="x509__crt_8h_html_a09dd1d818f15b9655f5dbcd3d7c1ec0f"><div class="ttname"><a href="x509__crt_8h.html#a09dd1d818f15b9655f5dbcd3d7c1ec0f">mbedtls_x509write_crt_set_subject_key_identifier</a></div><div class="ttdeci">int mbedtls_x509write_crt_set_subject_key_identifier(mbedtls_x509write_cert *ctx)</div><div class="ttdoc">Set the subjectKeyIdentifier extension for a CRT Requires that mbedtls_x509write_crt_set_subject_key(...</div></div>
<div class="ttc" id="x509__crt_8h_html_a272798b488a8ad984c4db95142392ba6"><div class="ttname"><a href="x509__crt_8h.html#a272798b488a8ad984c4db95142392ba6">mbedtls_x509write_crt_set_subject_name</a></div><div class="ttdeci">int mbedtls_x509write_crt_set_subject_name(mbedtls_x509write_cert *ctx, const char *subject_name)</div><div class="ttdoc">Set the subject name for a Certificate Subject names should contain a comma-separated list of OID typ...</div></div>
<div class="ttc" id="md_8h_html_a219313cb40503ec3e34a857ab98b2296a7634aa1a264b0e1a5ec65f4ed77468f8"><div class="ttname"><a href="md_8h.html#a219313cb40503ec3e34a857ab98b2296a7634aa1a264b0e1a5ec65f4ed77468f8">MBEDTLS_MD_SHA256</a></div><div class="ttdef"><b>Definition:</b> <a href="md_8h_source.html#l00046">md.h:46</a></div></div>
<div class="ttc" id="x509__csr_8h_html"><div class="ttname"><a href="x509__csr_8h.html">x509_csr.h</a></div><div class="ttdoc">X.509 certificate signing request parsing and writing. </div></div>
<div class="ttc" id="structmbedtls__x509__crt_html_a6a0158fab362fa830848b1bc5dff7da4"><div class="ttname"><a href="structmbedtls__x509__crt.html#a6a0158fab362fa830848b1bc5dff7da4">mbedtls_x509_crt::pk</a></div><div class="ttdeci">mbedtls_pk_context pk</div><div class="ttdef"><b>Definition:</b> <a href="x509__crt_8h_source.html#l00070">x509_crt.h:70</a></div></div>
<div class="ttc" id="x509__crt_8h_html_ac7f9ece75e647023a0411a7bfa72b9f1"><div class="ttname"><a href="x509__crt_8h.html#ac7f9ece75e647023a0411a7bfa72b9f1">mbedtls_x509write_crt_set_validity</a></div><div class="ttdeci">int mbedtls_x509write_crt_set_validity(mbedtls_x509write_cert *ctx, const char *not_before, const char *not_after)</div><div class="ttdoc">Set the validity period for a Certificate Timestamps should be in string format for UTC timezone i...</div></div>
<div class="ttc" id="pk_8h_html_ac6a9786d96abfd73c4dff6814238feb9"><div class="ttname"><a href="pk_8h.html#ac6a9786d96abfd73c4dff6814238feb9">mbedtls_pk_free</a></div><div class="ttdeci">void mbedtls_pk_free(mbedtls_pk_context *ctx)</div><div class="ttdoc">Free a mbedtls_pk_context. </div></div>
<div class="ttc" id="x509__crt_8h_html_a416f26146d68bb79aac90e8e48bbe7df"><div class="ttname"><a href="x509__crt_8h.html#a416f26146d68bb79aac90e8e48bbe7df">mbedtls_x509write_crt_set_issuer_key</a></div><div class="ttdeci">void mbedtls_x509write_crt_set_issuer_key(mbedtls_x509write_cert *ctx, mbedtls_pk_context *key)</div><div class="ttdoc">Set the issuer key used for signing the certificate. </div></div>
<div class="ttc" id="structmbedtls__x509__crt_html_a7a0c0b511d5f2eda5a5dab75cca51441"><div class="ttname"><a href="structmbedtls__x509__crt.html#a7a0c0b511d5f2eda5a5dab75cca51441">mbedtls_x509_crt::subject</a></div><div class="ttdeci">mbedtls_x509_name subject</div><div class="ttdef"><b>Definition:</b> <a href="x509__crt_8h_source.html#l00065">x509_crt.h:65</a></div></div>
<div class="ttc" id="x509_8h_html_a0dc99e9a29593ae1ab51361870b5e555"><div class="ttname"><a href="x509_8h.html#a0dc99e9a29593ae1ab51361870b5e555">MBEDTLS_X509_NS_CERT_TYPE_OBJECT_SIGNING</a></div><div class="ttdeci">#define MBEDTLS_X509_NS_CERT_TYPE_OBJECT_SIGNING</div><div class="ttdef"><b>Definition:</b> <a href="x509_8h_source.html#l00132">x509.h:132</a></div></div>
<div class="ttc" id="x509__crt_8h_html"><div class="ttname"><a href="x509__crt_8h.html">x509_crt.h</a></div><div class="ttdoc">X.509 certificate parsing and writing. </div></div>
<div class="ttc" id="x509_8h_html_ad3c4beaae071ce4418697df9c0950021"><div class="ttname"><a href="x509_8h.html#ad3c4beaae071ce4418697df9c0950021">MBEDTLS_X509_KU_DATA_ENCIPHERMENT</a></div><div class="ttdeci">#define MBEDTLS_X509_KU_DATA_ENCIPHERMENT</div><div class="ttdef"><b>Definition:</b> <a href="x509_8h_source.html#l00117">x509.h:117</a></div></div>
<div class="ttc" id="ctr__drbg_8h_html_ad93d675f998550b4478c1fe6f4f34ebc"><div class="ttname"><a href="ctr__drbg_8h.html#ad93d675f998550b4478c1fe6f4f34ebc">mbedtls_ctr_drbg_seed</a></div><div class="ttdeci">int mbedtls_ctr_drbg_seed(mbedtls_ctr_drbg_context *ctx, int(*f_entropy)(void *, unsigned char *, size_t), void *p_entropy, const unsigned char *custom, size_t len)</div><div class="ttdoc">CTR_DRBG initial seeding Seed and setup entropy source for future reseeds. </div></div>
<div class="ttc" id="bignum_8h_html_a99c7cca612b47dc4f3b96905c4f9d69e"><div class="ttname"><a href="bignum_8h.html#a99c7cca612b47dc4f3b96905c4f9d69e">mbedtls_mpi_init</a></div><div class="ttdeci">void mbedtls_mpi_init(mbedtls_mpi *X)</div><div class="ttdoc">Initialize one MPI (make internal references valid) This just makes it ready to be set or freed...</div></div>
<div class="ttc" id="x509_8h_html_ad7e93b186781f0474f8662fb2a83c370"><div class="ttname"><a href="x509_8h.html#ad7e93b186781f0474f8662fb2a83c370">MBEDTLS_X509_KU_KEY_ENCIPHERMENT</a></div><div class="ttdeci">#define MBEDTLS_X509_KU_KEY_ENCIPHERMENT</div><div class="ttdef"><b>Definition:</b> <a href="x509_8h_source.html#l00116">x509.h:116</a></div></div>
<div class="ttc" id="entropy_8h_html_a06778439f8a0e2daa2d3b444e06ad8dd"><div class="ttname"><a href="entropy_8h.html#a06778439f8a0e2daa2d3b444e06ad8dd">mbedtls_entropy_free</a></div><div class="ttdeci">void mbedtls_entropy_free(mbedtls_entropy_context *ctx)</div><div class="ttdoc">Free the data in the context. </div></div>
<div class="ttc" id="x509__crt_8h_html_a5378017315ad6ac4da70f07777259e19"><div class="ttname"><a href="x509__crt_8h.html#a5378017315ad6ac4da70f07777259e19">mbedtls_x509write_crt_set_issuer_name</a></div><div class="ttdeci">int mbedtls_x509write_crt_set_issuer_name(mbedtls_x509write_cert *ctx, const char *issuer_name)</div><div class="ttdoc">Set the issuer name for a Certificate Issuer names should contain a comma-separated list of OID types...</div></div>
<div class="ttc" id="pk_8h_html_a935d710e542409462d0209f2381da83e"><div class="ttname"><a href="pk_8h.html#a935d710e542409462d0209f2381da83e">mbedtls_pk_parse_keyfile</a></div><div class="ttdeci">int mbedtls_pk_parse_keyfile(mbedtls_pk_context *ctx, const char *path, const char *password)</div><div class="ttdoc">Load and parse a private key. </div></div>
<div class="ttc" id="group__x509__module_html_gad4da63133d3590aa311488497d4c38ec"><div class="ttname"><a href="group__x509__module.html#gad4da63133d3590aa311488497d4c38ec">mbedtls_x509_crt_parse_file</a></div><div class="ttdeci">int mbedtls_x509_crt_parse_file(mbedtls_x509_crt *chain, const char *path)</div><div class="ttdoc">Load one or more certificates and add them to the chained list. Parses permissively. If some certificates can be parsed, the result is the number of failed certificates it encountered. If none complete correctly, the first error is returned. </div></div>
<div class="ttc" id="cert__write_8c_html_af846397815d6b78aadc6ce9bb6bc9238"><div class="ttname"><a href="cert__write_8c.html#af846397815d6b78aadc6ce9bb6bc9238">mbedtls_printf</a></div><div class="ttdeci">#define mbedtls_printf</div><div class="ttdef"><b>Definition:</b> <a href="cert__write_8c_source.html#l00032">cert_write.c:32</a></div></div>
<div class="ttc" id="key__app__writer_8c_html_a63119d4a849bfda6c0701a6ec9c20b68"><div class="ttname"><a href="key__app__writer_8c.html#a63119d4a849bfda6c0701a6ec9c20b68">DFL_OUTPUT_FILENAME</a></div><div class="ttdeci">#define DFL_OUTPUT_FILENAME</div><div class="ttdef"><b>Definition:</b> <a href="key__app__writer_8c_source.html#l00058">key_app_writer.c:58</a></div></div>
<div class="ttc" id="x509_8h_html_a632958cb9a2a77af495536a40e1b9fef"><div class="ttname"><a href="x509_8h.html#a632958cb9a2a77af495536a40e1b9fef">MBEDTLS_X509_NS_CERT_TYPE_SSL_SERVER</a></div><div class="ttdeci">#define MBEDTLS_X509_NS_CERT_TYPE_SSL_SERVER</div><div class="ttdef"><b>Definition:</b> <a href="x509_8h_source.html#l00130">x509.h:130</a></div></div>
<div class="ttc" id="x509_8h_html_a435813d11986e4ffc168e13637b66f26"><div class="ttname"><a href="x509_8h.html#a435813d11986e4ffc168e13637b66f26">MBEDTLS_X509_NS_CERT_TYPE_EMAIL</a></div><div class="ttdeci">#define MBEDTLS_X509_NS_CERT_TYPE_EMAIL</div><div class="ttdef"><b>Definition:</b> <a href="x509_8h_source.html#l00131">x509.h:131</a></div></div>
<div class="ttc" id="structmbedtls__x509write__cert_html_a04f54cf981e4c883878068c8086ab233"><div class="ttname"><a href="structmbedtls__x509write__cert.html#a04f54cf981e4c883878068c8086ab233">mbedtls_x509write_cert::not_before</a></div><div class="ttdeci">char not_before[MBEDTLS_X509_RFC5280_UTC_TIME_LEN+1]</div><div class="ttdef"><b>Definition:</b> <a href="x509__crt_8h_source.html#l00139">x509_crt.h:139</a></div></div>
<div class="ttc" id="x509__crt_8h_html_a32c8ac687c84d8066213297e6813c2f0"><div class="ttname"><a href="x509__crt_8h.html#a32c8ac687c84d8066213297e6813c2f0">mbedtls_x509write_crt_set_serial</a></div><div class="ttdeci">int mbedtls_x509write_crt_set_serial(mbedtls_x509write_cert *ctx, const mbedtls_mpi *serial)</div><div class="ttdoc">Set the serial number for a Certificate. </div></div>
<div class="ttc" id="structmbedtls__mpi_html"><div class="ttname"><a href="structmbedtls__mpi.html">mbedtls_mpi</a></div><div class="ttdoc">MPI structure. </div><div class="ttdef"><b>Definition:</b> <a href="bignum_8h_source.html#l00144">bignum.h:144</a></div></div>
<div class="ttc" id="x509_8h_html_a178dff35633f812860ff7abe7898a8a8"><div class="ttname"><a href="x509_8h.html#a178dff35633f812860ff7abe7898a8a8">MBEDTLS_X509_NS_CERT_TYPE_OBJECT_SIGNING_CA</a></div><div class="ttdeci">#define MBEDTLS_X509_NS_CERT_TYPE_OBJECT_SIGNING_CA</div><div class="ttdef"><b>Definition:</b> <a href="x509_8h_source.html#l00136">x509.h:136</a></div></div>
<div class="ttc" id="x509__crt_8h_html_aacd2986253f977770c2353a54cf2e670"><div class="ttname"><a href="x509__crt_8h.html#aacd2986253f977770c2353a54cf2e670">mbedtls_x509write_crt_free</a></div><div class="ttdeci">void mbedtls_x509write_crt_free(mbedtls_x509write_cert *ctx)</div><div class="ttdoc">Free the contents of a CRT write context. </div></div>
<div class="ttc" id="structmbedtls__x509__crt_html"><div class="ttname"><a href="structmbedtls__x509__crt.html">mbedtls_x509_crt</a></div><div class="ttdef"><b>Definition:</b> <a href="x509__crt_8h_source.html#l00052">x509_crt.h:52</a></div></div>
<div class="ttc" id="x509_8h_html_a576f34a7432238db229137bdfc3cfde0"><div class="ttname"><a href="x509_8h.html#a576f34a7432238db229137bdfc3cfde0">mbedtls_x509_dn_gets</a></div><div class="ttdeci">int mbedtls_x509_dn_gets(char *buf, size_t size, const mbedtls_x509_name *dn)</div><div class="ttdoc">Store the certificate DN in printable form into buf; no more than size characters will be written...</div></div>
<div class="ttc" id="x509_8h_html_abce173357d84bc4597b12952a193011c"><div class="ttname"><a href="x509_8h.html#abce173357d84bc4597b12952a193011c">MBEDTLS_X509_KU_KEY_AGREEMENT</a></div><div class="ttdeci">#define MBEDTLS_X509_KU_KEY_AGREEMENT</div><div class="ttdef"><b>Definition:</b> <a href="x509_8h_source.html#l00118">x509.h:118</a></div></div>
<div class="ttc" id="group__x509__module_html_ga016dd06bc770e77b84005f305df20ed1"><div class="ttname"><a href="group__x509__module.html#ga016dd06bc770e77b84005f305df20ed1">mbedtls_x509_crt_init</a></div><div class="ttdeci">void mbedtls_x509_crt_init(mbedtls_x509_crt *crt)</div><div class="ttdoc">Initialize a certificate (chain) </div></div>
<div class="ttc" id="x509_8h_html_a6937b6cde9a8a30a3967b6c2288e9d2d"><div class="ttname"><a href="x509_8h.html#a6937b6cde9a8a30a3967b6c2288e9d2d">MBEDTLS_X509_KU_KEY_CERT_SIGN</a></div><div class="ttdeci">#define MBEDTLS_X509_KU_KEY_CERT_SIGN</div><div class="ttdef"><b>Definition:</b> <a href="x509_8h_source.html#l00119">x509.h:119</a></div></div>
<div class="ttc" id="structmbedtls__x509__csr_html_a7a0c0b511d5f2eda5a5dab75cca51441"><div class="ttname"><a href="structmbedtls__x509__csr.html#a7a0c0b511d5f2eda5a5dab75cca51441">mbedtls_x509_csr::subject</a></div><div class="ttdeci">mbedtls_x509_name subject</div><div class="ttdef"><b>Definition:</b> <a href="x509__csr_8h_source.html#l00058">x509_csr.h:58</a></div></div>
<div class="ttc" id="third__party_2mbedtls_2repo_2include_2mbedtls_2platform_8h_html"><div class="ttname"><a href="third__party_2mbedtls_2repo_2include_2mbedtls_2platform_8h.html">platform.h</a></div></div>
<div class="ttc" id="ctr__drbg_8h_html"><div class="ttname"><a href="ctr__drbg_8h.html">ctr_drbg.h</a></div><div class="ttdoc">CTR_DRBG based on AES-256 (NIST SP 800-90) </div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon May 15 2017 18:32:27 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
