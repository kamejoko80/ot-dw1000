<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OT-DW1000: Openthread NCP Example with DW1000</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Open-Thread-Logo-200x42.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OT-DW1000
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Openthread NCP Example with DW1000 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>NCP is a low-power Wireless Network Co-Processor, can be a Border Router to connect the thread network with the external network with Wpantund Interface Running on the host (Linux PC).</p>
<h2>Running NCP with Wpantund</h2>
<ol type="1">
<li>Flash the NCP binary file on to the Nordic board and connect it to Linux PC via USB port.</li>
<li>Open a Terminal and Run the following command <div class="fragment"><div class="line">sudo /usr/local/sbin/wpantund -o NCPSocketName /dev/ttyACM0 -o WPANInterfaceName wpan0</div></div><!-- fragment --> The above command will run the Wpantund Interface on the Linux PC with name wpan0 and initializes the NCP.</li>
<li>To configure the NCP ,wpantund provides “wpanctl” command line tool. To use it Open an another terminal and run the following command <div class="fragment"><div class="line">sudo wpanctl -I wpan0</div></div><!-- fragment --> A command line to control/configure NCP appears as <code>wpanctl:wpan0</code> <div class="fragment"><div class="line">wpanctl:wpan0&gt;</div></div><!-- fragment --> 4.Now by following NCP commands , we can configure the NCP. <code>help</code> command will list the available commands. <div class="fragment"><div class="line">Wpanctl:wpan0&gt;help</div><div class="line">Commands:</div><div class="line">   join                          Join a WPAN.</div><div class="line">   form                          Form a new WPAN.</div><div class="line">   attach                        Attach/resume a previously commissioned network</div><div class="line">   reset                         Reset the NCP</div><div class="line">   begin-low-power               Enter low-power mode</div><div class="line">   leave                         Abandon the currently connected WPAN.</div><div class="line">   poll                          Poll the parent immediately to see if there is IP traffic</div><div class="line">   config-gateway                Configure gateway</div><div class="line">   add-route                     Add external route prefix</div><div class="line">   remove-route                  Remove external route prefix</div><div class="line">   list                          List available interfaces.</div><div class="line">   status                        Retrieve the status of the interface.</div><div class="line">   permit-join                   Permit other devices to join the current network.</div><div class="line">   scan                          Scan for nearby networks.</div><div class="line">   mfg                           Execute manufacturing command.</div><div class="line">   getprop                       Get a property.</div><div class="line">   setprop                       Set a property.</div><div class="line">   begin-net-wake                Initiate a network wakeup</div><div class="line">   host-did-wake                 Perform any host-wakeup related tasks</div><div class="line">   pcap                          Start a packet capture</div><div class="line">   cd                            Change current interface (command mode)</div><div class="line">   quit                          Terminate command line mode.</div><div class="line">   help                          Display this help.</div><div class="line">   clear                         Clear shell.</div><div class="line">wpanctl:wpan0&gt;</div></div><!-- fragment --></li>
<li><code>status</code> command will display the status of the NCP. <div class="fragment"><div class="line">wpanctl:wpan0&gt;status</div><div class="line">wpan0 =&gt; [</div><div class="line">        &quot;NCP:State&quot; =&gt; &quot;offline&quot;</div><div class="line">        &quot;Daemon:Enabled&quot; =&gt; true</div><div class="line">        &quot;NCP:Version&quot; =&gt; &quot;OPENTHREAD/0.01.00; NRF52840; Mar 27 2017 10:06:23&quot;</div><div class="line">        &quot;Daemon:Version&quot; =&gt; &quot;0.08.00 (/f911961-dirty; Mar 31 2017 11:32:13)&quot;</div><div class="line">        &quot;Config:NCP:DriverName&quot; =&gt; &quot;spinel&quot;</div><div class="line">        &quot;NCP:HardwareAddress&quot; =&gt; [B8DD443A6E973DEB]</div><div class="line">]</div></div><!-- fragment --> <h2>Making NCP as end device and CLI node as Leader:</h2>
</li>
</ol>
<ol type="1">
<li>Start a CLI node in a seperate serial terminal (with suitable parameters,let's assume PANID=0xdeca, Channel 5 ), so it will become Leader of the newly formed network.</li>
<li>To Join NCP Node to the above network , use <code>scan</code> and <code>Join</code> commands. On wpanctl <div class="fragment"><div class="line">wpanctl:wpan0&gt; scan</div><div class="line">   | Joinable | NetworkName        | PAN ID | Ch | XPanID           | HWAddr           | RSSI</div><div class="line">---+----------+--------------------+--------+----+------------------+------------------+------</div><div class="line"> 1 |       NO | &quot;OpenThread&quot;       | 0xDECA | 5 | DEAD00BEEF00CAFE | AA9D0AFEC741A253 |  -67</div></div><!-- fragment --></li>
<li>Use <code>join</code> command with Network Id the with option <div class="fragment"><div class="line">wpanctl:wpan0&gt; join 1</div><div class="line">Joining &quot;OpenThread&quot; DEAD00BEEF00CAFE as node type &quot;end-device&quot;</div><div class="line">Successfully Joined!</div></div><!-- fragment --></li>
<li>Check the <code>status</code>. <div class="fragment"><div class="line">wpanctl:wpan0&gt; status</div><div class="line">wpan0 =&gt; [</div><div class="line">        &quot;NCP:State&quot; =&gt; &quot;associated&quot;</div><div class="line">        &quot;Daemon:Enabled&quot; =&gt; true</div><div class="line">        &quot;NCP:Version&quot; =&gt; &quot;OPENTHREAD/0.01.00; none; May 12 2017 11:47:38&quot;</div><div class="line">        &quot;Daemon:Version&quot; =&gt; &quot;0.08.00d (/f911961-dirty; May  5 2017 10:52:26)&quot;</div><div class="line">        &quot;Config:NCP:DriverName&quot; =&gt; &quot;spinel&quot;</div><div class="line">        &quot;NCP:HardwareAddress&quot; =&gt; [18B4300000000002]</div><div class="line">        &quot;NCP:Channel&quot; =&gt; 5</div><div class="line">        &quot;Network:NodeType&quot; =&gt; &quot;end-device&quot;</div><div class="line">        &quot;Network:Name&quot; =&gt; &quot;Open Thread&quot;</div><div class="line">        &quot;Network:XPANID&quot; =&gt; 0x64941B1C5D9C8F10</div><div class="line">        &quot;Network:PANID&quot; =&gt; 0xDECA</div><div class="line">        &quot;IPv6:LinkLocalAddress&quot; =&gt; &quot;fe80::24b1:b3df:dc48:9585&quot;</div><div class="line">        &quot;IPv6:MeshLocalAddress&quot; =&gt; &quot;fd64:941b:1c5d:0:7c34:ca08:8028:352c&quot;</div><div class="line">        &quot;IPv6:MeshLocalPrefix&quot; =&gt; &quot;fd64:941b:1c5d::/64&quot;</div><div class="line">        &quot;com.nestlabs.internal:Network:AllowingJoin&quot; =&gt; false</div><div class="line">]</div><div class="line">wpanctl:wpan0&gt;</div></div><!-- fragment --></li>
<li>It is Possible to ping with the MeshLocalAddress of NCP from the CLI node using ping command. On cli run this command <div class="fragment"><div class="line">ping fd64:941b:1c5d:0:7c34:ca08:8028:352c</div><div class="line"> 16 bytes from fd64:941b:1c5d:0:7c34:ca08:8028:352c icmp_seq=1 hlim=64 time=121ms</div></div><!-- fragment --></li>
<li>Also from the Linux terminal , it is possible to ping with the above IP address and the IP addresses available on the CLI node.</li>
</ol>
<p>On Linux Terminal (use ping6 ) </p><div class="fragment"><div class="line">ping6 fd64:941b:1c5d:0:7c34:ca08:8028:352c</div><div class="line">PING fd64:941b:1c5d:0:7c34:ca08:8028:352c(fd64:941b:1c5d:0:7c34:ca08:8028:352c) 56 data bytes</div><div class="line">64 bytes from fd64:941b:1c5d:0:7c34:ca08:8028:352c: icmp_seq=1 ttl=64 time=0.015 ms</div><div class="line">64 bytes from fd64:941b:1c5d:0:7c34:ca08:8028:352c: icmp_seq=1 ttl=64 time=0.015 ms</div><div class="line">64 bytes from fd64:941b:1c5d:0:7c34:ca08:8028:352c: icmp_seq=1 ttl=64 time=0.015 ms</div><div class="line">.</div><div class="line">.</div></div><!-- fragment --> <h2>Making NCP as Leader and CLI node as end-device/Child:</h2>
<ol type="1">
<li>Start a NCP Node by flashing the NCP binary onto one Nordic board.</li>
<li>Open the wpanctl to confiure the NCP.</li>
<li>By using <code>form</code> command , NCP can create a Network as a Leader <div class="fragment"><div class="line">wpanctl:wpan0&gt; form Thread_Name</div><div class="line">Forming WPAN &quot;Thread_Name&quot; as node type &quot;router&quot;</div><div class="line">Successfully formed!</div></div><!-- fragment --></li>
<li>Now check the <code>status</code>. <div class="fragment"><div class="line">wpanctl:wpan0&gt; status</div><div class="line">wpan0 =&gt; [</div><div class="line">        &quot;NCP:State&quot; =&gt; &quot;associated&quot;</div><div class="line">        &quot;Daemon:Enabled&quot; =&gt; true</div><div class="line">        &quot;NCP:Version&quot; =&gt; &quot;OPENTHREAD/0.01.00; none; May 12 2017 11:47:38&quot;</div><div class="line">        &quot;Daemon:Version&quot; =&gt; &quot;0.08.00d (/f911961-dirty; May  5 2017 10:52:26)&quot;</div><div class="line">        &quot;Config:NCP:DriverName&quot; =&gt; &quot;spinel&quot;</div><div class="line">        &quot;NCP:HardwareAddress&quot; =&gt; [18B4300000000002]</div><div class="line">        &quot;NCP:Channel&quot; =&gt; 19</div><div class="line">        &quot;Network:NodeType&quot; =&gt; &quot;leader&quot;</div><div class="line">        &quot;Network:Name&quot; =&gt; &quot;Thread_Name&quot;</div><div class="line">        &quot;Network:XPANID&quot; =&gt; 0x64941B1C5D9C8F10</div><div class="line">        &quot;Network:PANID&quot; =&gt; 0x803B</div><div class="line">        &quot;IPv6:LinkLocalAddress&quot; =&gt; &quot;fe80::24b1:b3df:dc48:9585&quot;</div><div class="line">        &quot;IPv6:MeshLocalAddress&quot; =&gt; &quot;fd64:941b:1c5d:0:7c34:ca08:8028:352c&quot;</div><div class="line">        &quot;IPv6:MeshLocalPrefix&quot; =&gt; &quot;fd64:941b:1c5d::/64&quot;</div><div class="line">        &quot;com.nestlabs.internal:Network:AllowingJoin&quot; =&gt; false</div><div class="line">]</div><div class="line">wpanctl:wpan0&gt;</div></div><!-- fragment --></li>
<li><code>getprop</code> will list all the parameters of the NCP Node. <div class="fragment"><div class="line">wpanctl:wpan0&gt;getprop</div></div><!-- fragment --></li>
<li>Now Run a CLI node in second board with the same parameters observed on the NCP (Panid , channel , Masterkey).</li>
<li>Soon , CLI node will join the Network as a child. It can be ensured by using <code>state</code> command and <code>parent</code> commands on the CLI Node.</li>
<li>It is Possible to ping with the MeshLocalAddress of NCP from the CLI node using <code>ping</code> command. On CLI Node run this command</li>
</ol>
<div class="fragment"><div class="line">Ping fd64:941b:1c5d:0:7c34:ca08:8028:352c</div><div class="line">  &gt; 16 bytes from fd64:941b:1c5d:0:7c34:ca08:8028:352c icmp_seq=1 hlim=64 time=121ms</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 21 2017 18:58:05 for OT-DW1000 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
