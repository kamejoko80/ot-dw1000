<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SPI Slave</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Open-Thread-Logo-200x42.png"/></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">CLI and NCP Application</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">SPI Slave<div class="ingroups"><a class="el" href="group__platform.html">Platform Abstraction</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This module includes the platform abstraction for SPI slave communication.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gaed8c26f734d3a2ba4ec543e9e94a0cf2"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi-slave.html#gaed8c26f734d3a2ba4ec543e9e94a0cf2">otPlatSpiSlaveTransactionCompleteCallback</a>) (void *aContext, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *anOutputBuf, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> anOutputBufLen, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *anInputBuf, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> anInputBufLen, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> aTransactionLength)</td></tr>
<tr class="separator:gaed8c26f734d3a2ba4ec543e9e94a0cf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gab202b9e8a3a12e7e738467c4693acd44"><td class="memItemLeft" align="right" valign="top"><a class="el" href="openthread-types_8h.html#ab701d053a9c34ab7f11e43e0dc09ac9f">ThreadError</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi-slave.html#gab202b9e8a3a12e7e738467c4693acd44">otPlatSpiSlaveEnable</a> (<a class="el" href="group__spi-slave.html#gaed8c26f734d3a2ba4ec543e9e94a0cf2">otPlatSpiSlaveTransactionCompleteCallback</a> aCallback, void *aContext)</td></tr>
<tr class="separator:gab202b9e8a3a12e7e738467c4693acd44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3b386f4b585e8deafa475c873d13a532"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi-slave.html#ga3b386f4b585e8deafa475c873d13a532">otPlatSpiSlaveDisable</a> (void)</td></tr>
<tr class="separator:ga3b386f4b585e8deafa475c873d13a532"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga545203c4c963f46b40586b830d817a45"><td class="memItemLeft" align="right" valign="top"><a class="el" href="openthread-types_8h.html#ab701d053a9c34ab7f11e43e0dc09ac9f">ThreadError</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi-slave.html#ga545203c4c963f46b40586b830d817a45">otPlatSpiSlavePrepareTransaction</a> (<a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *anOutputBuf, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> anOutputBufLen, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *anInputBuf, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> anInputBufLen, <a class="el" href="stdbool_8h.html#afaa87723b8417d40fcf45b7330261ef9">bool</a> aRequestTransactionFlag)</td></tr>
<tr class="separator:ga545203c4c963f46b40586b830d817a45"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This module includes the platform abstraction for SPI slave communication. </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="gaed8c26f734d3a2ba4ec543e9e94a0cf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaed8c26f734d3a2ba4ec543e9e94a0cf2">&#9670;&nbsp;</a></span>otPlatSpiSlaveTransactionCompleteCallback</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* otPlatSpiSlaveTransactionCompleteCallback) (void *aContext, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *anOutputBuf, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> anOutputBufLen, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *anInputBuf, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> anInputBufLen, <a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> aTransactionLength)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Indicates that a SPI transaction has completed with the given length. The data written to the slave has been written to the pointer indicated by the <code>anInputBuf</code> argument to the previous call to <a class="el" href="group__spi-slave.html#ga545203c4c963f46b40586b830d817a45">otPlatSpiSlavePrepareTransaction()</a>.</p>
<p>Once this function is called, <a class="el" href="group__spi-slave.html#ga545203c4c963f46b40586b830d817a45">otPlatSpiSlavePrepareTransaction()</a> is invalid and must be called again for the next transaction to be valid.</p>
<p>Note that this function is always called at the end of a transaction, even if <a class="el" href="group__spi-slave.html#ga545203c4c963f46b40586b830d817a45">otPlatSpiSlavePrepareTransaction()</a> has not yet been called. In such cases, anOutputBufLen and anInputBufLen will be zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aContext</td><td>Context pointer passed into <a class="el" href="group__spi-slave.html#gab202b9e8a3a12e7e738467c4693acd44">otPlatSpiSlaveEnable()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">anOutputBuf</td><td>Value of anOutputBuf from last call to <a class="el" href="group__spi-slave.html#ga545203c4c963f46b40586b830d817a45">otPlatSpiSlavePrepareTransaction()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">anOutputBufLen</td><td>Value of anOutputBufLen from last call to <a class="el" href="group__spi-slave.html#ga545203c4c963f46b40586b830d817a45">otPlatSpiSlavePrepareTransaction()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">anInputBuf</td><td>Value of anInputBuf from last call to <a class="el" href="group__spi-slave.html#ga545203c4c963f46b40586b830d817a45">otPlatSpiSlavePrepareTransaction()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">anInputBufLen</td><td>Value of anInputBufLen from last call to <a class="el" href="group__spi-slave.html#ga545203c4c963f46b40586b830d817a45">otPlatSpiSlavePrepareTransaction()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aTransactionLength</td><td>Length of the completed transaction, in bytes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="spi-slave_8h_source.html#l00083">83</a> of file <a class="el" href="spi-slave_8h_source.html">spi-slave.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga3b386f4b585e8deafa475c873d13a532"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3b386f4b585e8deafa475c873d13a532">&#9670;&nbsp;</a></span>otPlatSpiSlaveDisable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void otPlatSpiSlaveDisable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Shutdown and disable the SPI slave interface. </p>

<p class="definition">Definition at line <a class="el" href="spi-stubs_8c_source.html#l00052">52</a> of file <a class="el" href="spi-stubs_8c_source.html">spi-stubs.c</a>.</p>

</div>
</div>
<a id="gab202b9e8a3a12e7e738467c4693acd44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab202b9e8a3a12e7e738467c4693acd44">&#9670;&nbsp;</a></span>otPlatSpiSlaveEnable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="openthread-types_8h.html#ab701d053a9c34ab7f11e43e0dc09ac9f">ThreadError</a> otPlatSpiSlaveEnable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__spi-slave.html#gaed8c26f734d3a2ba4ec543e9e94a0cf2">otPlatSpiSlaveTransactionCompleteCallback</a>&#160;</td>
          <td class="paramname"><em>aCallback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>aContext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the SPI slave interface.</p>
<p>Note that the SPI slave is not fully ready until a transaction is prepared using otPlatSPISlavePrepareTransaction().</p>
<p>If otPlatSPISlavePrepareTransaction() is not called before the master begins a transaction, the resulting SPI transaction will send all <code>0xFF</code> bytes and discard all received bytes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aCallback</td><td>Pointer to transaction complete callback </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aContext</td><td>Context pointer to be passed to transaction complete callback</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="openthread-types_8h.html#ab701d053a9c34ab7f11e43e0dc09ac9faad5780f7d9de1820e280b293330ea137">kThreadError_None</a></td><td>Successfully enabled the SPI Slave interface. </td></tr>
    <tr><td class="paramname"><a class="el" href="openthread-types_8h.html#ab701d053a9c34ab7f11e43e0dc09ac9fa58419c21193b24de982729f153fcab76">kThreadError_Already</a></td><td>SPI Slave interface is already enabled. </td></tr>
    <tr><td class="paramname"><a class="el" href="openthread-types_8h.html#ab701d053a9c34ab7f11e43e0dc09ac9fab13aaec895178d063d25eb32f346c9b2">kThreadError_Failed</a></td><td>Failed to enable the SPI Slave interface. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="spi-stubs_8c_source.html#l00038">38</a> of file <a class="el" href="spi-stubs_8c_source.html">spi-stubs.c</a>.</p>

</div>
</div>
<a id="ga545203c4c963f46b40586b830d817a45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga545203c4c963f46b40586b830d817a45">&#9670;&nbsp;</a></span>otPlatSpiSlavePrepareTransaction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="openthread-types_8h.html#ab701d053a9c34ab7f11e43e0dc09ac9f">ThreadError</a> otPlatSpiSlavePrepareTransaction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>anOutputBuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a>&#160;</td>
          <td class="paramname"><em>anOutputBufLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>anInputBuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a>&#160;</td>
          <td class="paramname"><em>anInputBufLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdbool_8h.html#afaa87723b8417d40fcf45b7330261ef9">bool</a>&#160;</td>
          <td class="paramname"><em>aRequestTransactionFlag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prepare data for the next SPI transaction. Data pointers MUST remain valid until the transaction complete callback is called by the SPI slave driver, or until after the next call to <a class="el" href="group__spi-slave.html#ga545203c4c963f46b40586b830d817a45">otPlatSpiSlavePrepareTransaction()</a>.</p>
<p>This function may be called more than once before the SPI master initiates the transaction. Each <em>successful</em> call to this function will cause the previous values from earlier calls to be discarded.</p>
<p>Not calling this function after a completed transaction is the same as if this function was previously called with both buffer lengths set to zero and aRequestTransactionFlag set to <code>false</code>.</p>
<p>Once anOutputBufLen bytes of anOutputBuf has been clocked out, the MISO pin shall be set high until the master finishes the SPI transaction. This is the functional equivalent of padding the end of anOutputBuf with 0xFF bytes out to the length of the transaction.</p>
<p>Once anInputBufLen bytes of anInputBuf have been clocked in from MOSI, all subsequent values from the MOSI pin are ignored until the SPI master finishes the transaction.</p>
<p>Note that even if <code>anInputBufLen</code> or <code>anOutputBufLen</code> (or both) are exhausted before the SPI master finishes a transaction, the ongoing size of the transaction must still be kept track of to be passed to the transaction complete callback. For example, if <code>anInputBufLen</code> is equal to 10 and <code>anOutputBufLen</code> equal to 20 and the SPI master clocks out 30 bytes, the value 30 is passed to the transaction complete callback.</p>
<p>Any call to this function while a transaction is in progress will cause all of the arguments to be ignored and the return value to be <a class="el" href="openthread-types_8h.html#ab701d053a9c34ab7f11e43e0dc09ac9fa61e9a4d4e64bca043dc999afdf2ca5ba">kThreadError_Busy</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">anOutputBuf</td><td>Data to be written to MISO pin </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">anOutputBufLen</td><td>Size of the output buffer, in bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">anInputBuf</td><td>Data to be read from MOSI pin </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">anInputBufLen</td><td>Size of the input buffer, in bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aRequestTransactionFlag</td><td>Set to true if host interrupt should be set</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="openthread-types_8h.html#ab701d053a9c34ab7f11e43e0dc09ac9faad5780f7d9de1820e280b293330ea137">kThreadError_None</a></td><td>Transaction was successfully prepared. </td></tr>
    <tr><td class="paramname"><a class="el" href="openthread-types_8h.html#ab701d053a9c34ab7f11e43e0dc09ac9fa61e9a4d4e64bca043dc999afdf2ca5ba">kThreadError_Busy</a></td><td>A transaction is currently in progress. </td></tr>
    <tr><td class="paramname"><a class="el" href="openthread-types_8h.html#ab701d053a9c34ab7f11e43e0dc09ac9faa8280c101a9310dfaf0bf9d49892c025">kThreadError_InvalidState</a></td><td><a class="el" href="group__spi-slave.html#gab202b9e8a3a12e7e738467c4693acd44">otPlatSpiSlaveEnable()</a> hasn't been called. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="spi-stubs_8c_source.html#l00056">56</a> of file <a class="el" href="spi-stubs_8c_source.html">spi-stubs.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon May 15 2017 18:32:35 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
